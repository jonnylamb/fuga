ui
==

* display activity timings in the row?

* use GtkBuilder

* work out what to do with icons

* implement multi-delete

* does deleting the last item break things? probably.

O add a .desktop file

* move strava UI code out of activities.py

misc
====

O work out name: correre or corri?

garmin connectivity
===================

* add a timeout when connecting

* ensure garmin connected to on a reconnection is the same one!

O work out why device busy warning always appears

O push all openant changes upstream

design
======

* make queuing not really ugly

* add "list current items" device as fakegarmin

* rename fakegarmin to something like dirlist and add edge 800 device

O change activity directory, losing garmin-extractor compatibility

known issues
============

* https://github.com/Tigge/openant/issues/14

tracebacks
==========

* duplicate strava upload

    {"id":244886565,"external_id":"2014-11-07_23-46-58_4_218.fit","error":"2014-11-07_23-46-58_4_218.fit duplicate of an uploading activity (244886541)","status":"There was an error processing your activity.","activity_id":null}
    Traceback (most recent call last):
      File "/home/jonny/src/run/utils.py", line 25, in read_stream_cb
        cb(data)
      File "/home/jonny/src/run/strava.py", line 80, in cb
        self.read_response(json.loads(data))
      File "/home/jonny/src/run/strava.py", line 93, in read_response
        self.activity_id = int(data['error'].split()[-1])

* on authentication

    Traceback (most recent call last):
      File "/usr/lib/python2.7/threading.py", line 810, in __bootstrap_inner
        self.run()
      File "/usr/lib/python2.7/threading.py", line 763, in run
        self.__target(*self.__args, **self.__kwargs)
      File "/home/jonny/src/run/garmin.py", line 284, in start
        ant.fs.manager.Application.start(self)
      File "/home/jonny/src/openant/ant/fs/manager.py", line 202, in start
        self._main()
      File "/home/jonny/src/openant/ant/fs/manager.py", line 131, in _main
        if self.on_authentication(beacon):
      File "/home/jonny/src/run/garmin.py", line 199, in on_authentication
        self.authentication_passkey(device.passkey)
      File "/home/jonny/src/openant/ant/fs/manager.py", line 356, in authentication_passkey
        response = self._get_command()
      File "/home/jonny/src/openant/ant/fs/manager.py", line 171, in _get_command
        c = self._queue.get(True, timeout)
      File "/usr/lib/python2.7/Queue.py", line 176, in get
        raise Empty
    Empty

* uploading to strava timing out

    Traceback (most recent call last):
      File "/home/jonny/src/run/strava.py", line 75, in sent_cb
        stream = session.send_finish(result)
    GLib.Error: g-io-error-quark: I/O sul socket scaduto (24)

* bad download

    Traceback (most recent call last):
      File "/home/jonny/src/run/garmin.py", line 221, in <lambda>
        GLib.idle_add(lambda: cb(ret))
      File "/home/jonny/src/run/activities.py", line 483, in file_downloaded_cb
        self.setup_fit()
      File "/home/jonny/src/run/activities.py", line 327, in setup_fit
        self.fit = fit.Fit(self.full_path)
      File "/home/jonny/src/run/fit.py", line 24, in __init__
        data_processor=fitparse.StandardUnitsDataProcessor())
      File "/home/jonny/src/python-fitparse/fitparse/base.py", line 56, in __init__
        self._parse_file_header()
      File "/home/jonny/src/python-fitparse/fitparse/base.py", line 97, in _parse_file_header
        raise FitParseError("Invalid .FIT File Header")
    fitparse.base.FitParseError: Invalid .FIT File Header

* nothing plugged in:

    Traceback (most recent call last):
      File "/home/jonny/src/run/app.py", line 106, in welcome_next_clicked_cb
        self.app.queue.get_file_list(self.got_file_list_cb)
      File "/home/jonny/src/run/queue.py", line 38, in __getattr__
        self.emit('garmin-changed', self.cls())
      File "/home/jonny/src/run/garmin.py", line 160, in __init__
        ant.fs.manager.Application.__init__(self)
      File "/home/jonny/src/openant/ant/fs/manager.py", line 82, in __init__
        self._node = Node()
      File "/home/jonny/src/openant/ant/easy/node.py", line 48, in __init__
        self.ant = Ant()
      File "/home/jonny/src/openant/ant/base/ant.py", line 46, in __init__
        self._driver = find_driver()
      File "/home/jonny/src/openant/ant/base/driver.py", line 248, in find_driver
        raise DriverNotFound
    ant.base.driver.DriverNotFound
